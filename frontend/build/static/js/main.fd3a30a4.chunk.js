(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){},20:function(e,t,a){e.exports=a.p+"static/media/logo.7baba3c1.svg"},21:function(e,t,a){e.exports=a(95)},95:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),c=a(19),r=a.n(c),i=(a(18),a(5)),l=a(3),s=a(20),u=a.n(s),p=a(0),m=a(6);var _=function(e){var t=e.email,a=e.onLogout,n=Object(p.l)();return o.a.createElement("div",{className:"header__navbar"},"/sign-in"===n.pathname?o.a.createElement(m.b,{to:"/sign-up",className:"header__link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"):"/sign-up"===n.pathname?o.a.createElement(m.b,{to:"/sign-in",className:"header__link"},"\u0412\u043e\u0439\u0442\u0438"):o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{className:"header__email"},t),o.a.createElement("button",{type:"button",className:"header__signout",onClick:a},"\u0412\u044b\u0439\u0442\u0438")))};var d=function(e){var t=e.email,a=e.onLogout;return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:u.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto"}),o.a.createElement(_,{email:t,onLogout:a}))};var h=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__text",lang:"en"},"\xa9 2023 Mesto Russia"))},f=o.a.createContext();var E=function(e){var t=o.a.useContext(f),a=e.card.likes.some(function(e){return e._id===t._id}),n=e.card.owner._id===t._id,c="element__btn-like ".concat(a&&"element__btn-like_active"),r="element__btn-del ".concat(n?"":"element__btn-del_none");return o.a.createElement("article",{className:"element",key:e.card._id},o.a.createElement("img",{className:"element__image",src:e.card.link,alt:e.card.alt,onClick:function(){e.onCardClick(e.card)}}),o.a.createElement("button",{className:r,type:"button",onClick:function(){e.onCardDelete(e.card)}}),o.a.createElement("div",{className:"element__description"},o.a.createElement("h2",{className:"element__name"},e.card.name),o.a.createElement("div",{className:"element__likes"},o.a.createElement("button",{className:c,type:"button",onClick:function(){e.onCardLike(e.card)}}),o.a.createElement("p",{className:"element__like_counter"},e.card.likes.length))))};var g=function(e){var t=Object(n.useContext)(f);return o.a.createElement("main",{className:"main"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__container"},o.a.createElement("button",{className:"profile__avatar-btn",type:"button",onClick:e.onEditAvatar}),o.a.createElement("img",{className:"profile__avatar",src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__wrap"},o.a.createElement("h1",{className:"profile__name"},t.name),o.a.createElement("button",{className:"profile__edit-btn",type:"button",onClick:e.onEditProfile})),o.a.createElement("p",{className:"profile__description"},t.about))),o.a.createElement("button",{className:"profile__add-btn",type:"button",onClick:e.onAddPlace})),o.a.createElement("section",{className:"elements"},e.cards.map(function(t){return o.a.createElement(E,{card:t,key:t._id,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})))};var b=function(e){var t=e.isOpen,a=e.onClose,n=e.name,c=e.title,r=e.btnText,i=e.children,l=e.onSubmit;return o.a.createElement("div",{className:"popup popup_".concat(n," ").concat(t?"popup_opened":" ")},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{className:"popup__btn-close",type:"button",onClick:a}),o.a.createElement("h3",{className:"popup__name"},"".concat(c)),o.a.createElement("form",{className:"form",name:"".concat(n,"_form"),onSubmit:l},i,o.a.createElement("button",{type:"submit",className:"popup__btn-submit"},"".concat(r)))))};var v=function(e){return o.a.createElement("div",{className:"popup popup_showimg ".concat(e.isOpen?"popup_opened":" ")},o.a.createElement("div",{className:"big-popup"},o.a.createElement("button",{className:"popup__btn-close",type:"button",onClick:e.onClose}),o.a.createElement("div",{className:"big-popup__container"},o.a.createElement("img",{className:"big-popup__image",src:"".concat(e.card.link),alt:"".concat(e.card.alt)}),o.a.createElement("h2",{className:"big-popup__name"},e.card.name))))};var k=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],s=r[1],u=o.a.useState(""),p=Object(l.a)(u,2),m=p[0],_=p[1],d=o.a.useContext(f);return o.a.useEffect(function(){s(d.name),_(d.about)},[d,t]),o.a.createElement(b,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",btnText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:i,about:m})}},o.a.createElement("input",{type:"text",id:"inputName",name:"name",className:"popup__input popup__input_el_name",minLength:"2",maxLength:"40",required:!0,onChange:function(e){s(e.target.value)},value:i||""}),o.a.createElement("span",{className:"inputName-error popup__input-error"}),o.a.createElement("input",{type:"text",id:"inputDescription",name:"about",className:"popup__input popup__input_el_description",required:!0,minLength:"2",maxLength:"200",onChange:function(e){_(e.target.value)},value:m||""}),o.a.createElement("span",{className:"inputDescription-error popup__input-error"}))};var N=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,c=o.a.useRef();return o.a.useEffect(function(){c.current.value=""},[t]),o.a.createElement(b,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"new-avatar",btnText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({avatar:c.current.value})}},o.a.createElement("input",{id:"inputAvatar",name:"link",className:"popup__input popup__input_avatar_src",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",type:"url",ref:c,required:!0}),o.a.createElement("span",{className:"inputAvatar-error popup__input-error"}))};var C=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],s=r[1],u=o.a.useState(""),p=Object(l.a)(u,2),m=p[0],_=p[1];return o.a.useEffect(function(){s(""),_("")},[t]),o.a.createElement(b,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",btnText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:i,link:m})}},o.a.createElement("input",{type:"text",id:"inputTitle",name:"name",className:"popup__input popup__input_el_title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0,value:i,onChange:function(e){s(e.target.value)}}),o.a.createElement("span",{className:"inputTitle-error popup__input-error"}),o.a.createElement("input",{type:"url",id:"inputLink",name:"link",className:"popup__input popup__input_el_link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:m,onChange:function(e){_(e.target.value)}}),o.a.createElement("span",{className:"inputLink-error popup__input-error"}))},y=a(7),j=a(8),O=new(function(){function e(t){var a=t.url,n=t.headers;Object(y.a)(this,e),this._url=a,this._headers=n}return Object(j.a)(e,[{key:"setToken",value:function(e){this._headers={"Content-Type":"application/json",authorization:"Bearer ".concat(e)}}},{key:"_checkResponse",value:function(e){return e.ok?e.json():(console.log("\u041e\u0448\u0438\u0431\u043a\u0430"),Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(this._checkResponse)}},{key:"editProfileInfo",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"addNewCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(this._checkResponse)}},{key:"changeLikeCard",value:function(e,t){return t?fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(this._checkResponse):fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"PUT",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(this._checkResponse)}}]),e}())({url:"https://mesto-backend.nomoredomains.rocks",headers:{"Content-Type":"application/json",Accept:"application/json"}});var S=function(e){var t=e.isLoggedIn,a=e.children;return t?a:o.a.createElement(p.a,{to:"/signin"})};var w=function(e){var t=e.message,a=e.onClose;return o.a.createElement("div",{className:"popup "+(t?"popup_opened":"")},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{className:"popup__btn-close",type:"button",onClick:a}),o.a.createElement("div",{className:"popup__infotooltip"+(t?t.isSuccess?" popup__infotooltip_success":" popup__infotooltip_error":"")}),o.a.createElement("h2",{className:"popup__infotooltip_message"},t?t.text:"")))},T=a(4),L=a(16),x=function(e){var t=e.onLogin,a=o.a.useState({email:"",password:""}),n=Object(l.a)(a,2),c=n[0],r=n[1],i=function(e){var t=e.target.value,a=e.target.name;r(Object(L.a)({},c,Object(T.a)({},a,t)))};return o.a.createElement(o.a.Fragment,null,o.a.createElement(d,null,o.a.createElement(m.b,{to:"/sign-in",className:"header__link"},"\u0412\u043e\u0439\u0442\u0438")),o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"auth"},o.a.createElement("div",{className:"auth__container"},o.a.createElement("h2",{className:"auth__title"},"\u0412\u0445\u043e\u0434"),o.a.createElement("form",{className:"auth__form",onSubmit:function(e){e.preventDefault(),t(c)}},o.a.createElement("input",{className:"popup__input auth__input",type:"email",name:"email",placeholder:"Email",minLength:"2",autoComplete:"off",value:c.email,onChange:i,required:!0}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"}),o.a.createElement("input",{className:"popup__input auth__input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",autoComplete:"off",value:c.password,onChange:i,required:!0}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"}),o.a.createElement("button",{type:"submit",className:"popup__btn-submit popup__btn-submit_auth"},"\u0412\u043e\u0439\u0442\u0438"))))))},I=function(e){var t=e.onRegister,a=o.a.useState({email:"",password:"",confirmPassword:""}),c=Object(l.a)(a,2),r=c[0],i=c[1],s=Object(p.n)(),u=function(e){var t=e.target,a=t.name,n=t.value;i(Object(L.a)({},r,Object(T.a)({},a,n)))};Object(n.useEffect)(function(){localStorage.getItem("token")&&s("/",{replace:!0})},[s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(d,null,o.a.createElement(m.b,{to:"/sign-up",className:"header__link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),o.a.createElement("main",{className:"page"},o.a.createElement("section",{className:"auth"},o.a.createElement("div",{className:"auth__container"},o.a.createElement("h2",{className:"auth__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("form",{className:"auth__form",onSubmit:function(e){e.preventDefault(),t(r)}},o.a.createElement("input",{className:"popup__input auth__input",type:"email",name:"email",placeholder:"Email",minLength:"2",autoComplete:"off",value:r.email,onChange:u,required:!0}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"}),o.a.createElement("input",{className:"popup__input auth__input",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",autoComplete:"off",value:r.password,onChange:u,required:!0}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"}),o.a.createElement("button",{type:"submit",className:"popup__btn-submit popup__btn-submit_auth"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement("p",{className:"auth__text"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",o.a.createElement(m.b,{to:"/sign-in",className:"auth__text_link"},"\u0412\u043e\u0439\u0442\u0438")))))))},A=new(function(){function e(t){Object(y.a)(this,e),this._url=t.url}return Object(j.a)(e,[{key:"_getResponseData",value:function(e){return e.json().then(function(e){throw new Error(e.message)})}},{key:"register",value:function(e){var t=this,a=e.email,n=e.password;return fetch("".concat(this._url,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:a,password:n})}).then(function(e){return e.ok?e.json():t._getResponseData(e)})}},{key:"authorization",value:function(e){var t=this,a=e.email,n=e.password;return fetch("".concat(this._url,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:a,password:n})}).then(function(e){return e.ok?e.json():t._getResponseData(e)})}},{key:"getContent",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(function(e){return e.ok?e.json():t._getResponseData(e)}).then(function(e){return e})}}]),e}())({url:"https://mesto-backend.nomoredomains.rocks"});var P=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],c=o.a.useState(!1),r=Object(l.a)(c,2),s=r[0],u=r[1],m=o.a.useState(!1),_=Object(l.a)(m,2),E=_[0],y=_[1],j=o.a.useState(!1),T=Object(l.a)(j,2),L=T[0],P=T[1],R=o.a.useState({name:"",link:""}),D=Object(l.a)(R,2),z=D[0],B=D[1],q=o.a.useState({}),U=Object(l.a)(q,2),J=U[0],M=U[1],F=o.a.useState([]),H=Object(l.a)(F,2),G=H[0],K=H[1],Q=o.a.useState(!1),V=Object(l.a)(Q,2),W=V[0],X=V[1],Y=o.a.useState(""),Z=Object(l.a)(Y,2),$=Z[0],ee=Z[1],te=o.a.useState(""),ae=Object(l.a)(te,2),ne=ae[0],oe=ae[1],ce=Object(p.n)();o.a.useEffect(function(){W&&Promise.all([O.getUserInfo(),O.getInitialCards()]).then(function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];console.log(a),M(a.data),K(n)}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})},[W]);var re=function(){n(!1),u(!1),y(!1),P(!1),oe(null),B({name:"",link:""})};function ie(){X(!0)}function le(){localStorage.removeItem("token"),X(!1)}function se(e){oe(e)}return o.a.useEffect(function(){var e=localStorage.getItem("token");e&&A.getContent(e).then(function(e){ee(e.data.email),ce("/",{replace:!0}),ie()}).catch(function(e){return console.log(e)})},[ce]),o.a.createElement("div",{className:"root"},o.a.createElement(f.Provider,{value:J},o.a.createElement("div",{className:"page"},o.a.createElement(p.d,null,o.a.createElement(p.b,{path:"/",element:o.a.createElement(S,{isLoggedIn:W},o.a.createElement(d,{title:"\u0412\u044b\u0439\u0442\u0438",email:$,onLogout:le}),o.a.createElement(g,{cards:G,onEditProfile:function(){n(!0)},onAddPlace:function(){u(!0)},onEditAvatar:function(){y(!0)},onCardClick:function(e){P(!0),B(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===J._id});O.changeLikeCard(e._id,t).then(function(t){K(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})},onCardDelete:function(e){O.deleteCard(e._id).then(function(){K(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})},onLogout:le,email:$}),o.a.createElement(h,null))}),o.a.createElement(p.b,{path:"/sign-in",element:o.a.createElement(x,{onLogin:function(e){var t=e.email,a=e.password;A.authorization({email:t,password:a}).then(function(e){e.token&&localStorage.setItem("token",e.token),O.setToken(e.token),ie(),ce("/",{replace:!0})}).catch(function(e){se({text:e.message||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",isSuccess:!1})})},handleShowInfoMessage:se,email:$})}),o.a.createElement(p.b,{path:"/sign-up",element:o.a.createElement(I,{onRegister:function(e){var t=e.email,a=e.password;A.register({email:t,password:a}).then(function(e){se({text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",isSuccess:!0}),ce("/sign-in",{replace:!0})}).catch(function(e){se({text:e.message||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",isSuccess:!1})})},handleShowInfoMessage:se})}),o.a.createElement(p.b,{path:"*",element:W?o.a.createElement(p.a,{to:"/"}):o.a.createElement(p.a,{to:"/sign-in"})})),o.a.createElement(k,{isOpen:a,onClose:re,onUpdateUser:function(e){O.editProfileInfo(e).then(function(e){M(e),re()}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(N,{isOpen:E,onClose:re,onUpdateAvatar:function(e){O.changeAvatar(e).then(function(e){M(e),re()}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(C,{isOpen:s,onClose:re,onAddPlace:function(e){O.addNewCard(e).then(function(e){K([e].concat(Object(i.a)(G))),re()}).catch(function(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(b,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"submit",btnText:"\u0414\u0430"}),o.a.createElement(v,{isOpen:L,onClose:re,card:z}),o.a.createElement(w,{message:ne,onClose:re}))))};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(m.a,null,o.a.createElement(P,null)))}},[[21,2,1]]]);
//# sourceMappingURL=main.fd3a30a4.chunk.js.map